\documentclass[12pt,a4paper]{jsarticle}
\usepackage{amsmath,amssymb}
\usepackage{listings,jlisting}
\usepackage[dvipdfmx]{graphicx}

\lstset{
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\smallitshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  stepnumber=1,
  numbersep=1zw,
  lineskip=-0.5ex
}


\begin{document}

\begin{titlepage}
\title{オイラー法を用いた初期値問題}
\author{理学部応用数学科2年 $$1418104 \\前田 竜太}
\date{\today}
\maketitle
\end{titlepage}

%----------------------実験目的-----------------------
\section{実験目的}

%-----------------------問題設定-------------------------------
\section{問題設定}
今回は、以下の２つの常微分方程式を扱う
%それぞれの定数をここで与えてあげる
\begin{enumerate}
	\item \textbf{van der Pol 方程式}
		\begin{equation*}
		\left\{
		\begin{aligned}
		\frac{d^{2} x}{dt^{2}} - \mu(1 - x^{2})\frac{dx}{dt} + \omega^{2} x &= 0 ~~~ 0 < t < T\\
		x(0) &= x_0 \\
		\frac{dx}{dt}(0) &= y_0
		\end{aligned}
		\right.
		\end{equation*}
		ここで, パラメータ$\mu$と$\omega$は定数である.
	\item \textbf{Lotka Volterra 方程式}
		\begin{equation*}
		\left\{
		\begin{aligned}
		\frac{du}{dt} &= u(a_1 + b_1u + c_1v) ~~~ 0 < t < T \\
		\frac{dv}{dt} &= v(a_2 + b_2u + c_2v) ~~~ 0 < t < T \\
		x(0) &= x_0 \\ 
		y(0) &= y_0
		\end{aligned}
		\right.
		\end{equation*}
		ここで, パラメータ$a_1, b_1, c_1, a_2, b_2, c_2$は定数である. 
		%$a_1, a_2 > 0$とする. $c_1 > 0, b_2 > 0$のときを協調系, $c_1 < 0, b_2 > 0$のをきを被食者・捕食者系, $c_1 < 0, b_2 < 0$のときを競争系という.
\end{enumerate}
この2つの常微分方程式に, 様々な初期値や定数を与え, オイラー法を施すことによって数値解を求めていく.
%それぞれの初期値など与えてあげる


%-----------------------------理論--------------------------
\section{理論}
今回使うオイラー法についてだが. 変数$t$の$1$変数関数$x(t), y(t),\cdots$を未知関数とする$1$階以上の導関数を含む方程式を常微分方程式といい, 常微分方程式とその初期値が与えられたときの解を求める際. コンピュータは有限回の計算しか出来ないため, 微分を解析的に解くことが出来なく, 微分における極限計算を離散化し, 数値計算をしようとする手法の一つである.

具体的な定義としては. まず常微分方程式とその初期値を次のように定める.
$$ y'(t) = f(t, y), \quad y(t_0) = y_0$$
ここで$$ y'(t) = \lim_{h \to 0}\frac{y(t+h) - y(t)}{h} $$
と表わせるがコンピュータでは$\lim_{h \to 0}$が出来ないため$h$を離散化して考えると.
$$ y'(t) \doteq \frac{y(t+h) - y(t)}{h} $$
となり. 離散化した微分時間を$n$等分する$t_{i+1} = t_{i} + nh \quad i = 0, 1,\cdots, n-1$とし, 上記の式を変形すると.
$$ y(t_{i+1}) = y(t_i) + hf'(t_i, y) $$
これは, 関数$y$の時刻$t_i$における近似解を表している.

\subsection{van der Pol 方程式}
van der Pol 方程式において$y(t) = \frac{dx}{dt}$とすると, 方程式が
\begin{equation*}
	\left\{
	\begin{aligned}
		\frac{dy}{dt} - \mu(1 - x^2)y + \omega^2x &= 0 \quad 0 < t < T, \\
		\frac{dx}{dt} &= y \quad 0 < t < T, \\
		x(0) &= x_0, \\
		y(0) &= y_0
	\end{aligned}
	\right.
\end{equation*}
と変形することが出来る, そしてこれはオイラー法を適用出来る形となっているので, この変形した式にオイラー法を適用すると. $n = 0, 1,\cdots, N-1$ に対して
\begin{equation*}
	\left\{
	\begin{aligned}
		y(n+1) &= y(n) + h\{\mu(1 - x^2)y(n) - \omega^2x(n)\}, \\
		x(n+1) &= x(n) + hy(n), \\
		x(0) &= x_0, \\
		y(0) &= y_0
	\end{aligned}
	\right.
\end{equation*}
と表すことが出来る.変形した式に様々な初期値を与え, オイラー法を適用していきたいと思う.

また, van der Pol 方程式は非線形力学において重要な方程式の一つである. 

\subsection{Lotka Volterra 方程式}

\section{実験結果}
\section{考察}
\section{結論}
\section{参考文献}
\section{感想}






% --------------------------------------------------------
%問1
\subsection{}
計算問題、次の各問に答えよ。
%(1)
\subsubsection{}
$1000\sqrt{\sin(2018)}$の整数部分\par
答え. 943
\begin{lstlisting}
import math
print(int(1000*(math.sin(2018)**0.5)))
\end{lstlisting}
%(2)
\subsubsection{}
$(1+2\mathrm{i})^{10}$(ここで、$\mathrm{i}$は虚数単位である。)\par
答え. $237-3116\mathrm{i}$
\begin{lstlisting}
import math
print((1+2j)**10)
\end{lstlisting}
%(3)
\subsubsection{}
$\displaystyle\sum_{i=1}^{20} \frac{1}{i}$(分数で答えよ。)\par
答え. $\displaystyle\frac{55835135}{15519504}$\\
\begin{lstlisting}
from fractions import Fraction
sum = 0
for i in range(1,21):
    sum += Fraction(1,i)
print(Fraction(sum))
\end{lstlisting}
%(4)
\subsubsection{}
$\displaystyle1000(\sum_{i=1}^{1000} \frac{1}{i^{2}})$の整数部\par
答え. 1643
\begin{lstlisting}
from fractions import Fraction
sum = 0
for i in range(1,1001):
    sum += Fraction(1,i**2)
print(int(1000*sum))
\end{lstlisting}
%(5)
\subsubsection{}
$a_0 = 10$,$\displaystyle a_{n+1} = a_n - \frac{1}{a_n}$$(n=0,1,2,\dots)$とする、$a_n$がはじめて負になる$n$を答えよ。\par
答え. 52
\begin{lstlisting}
from fractions import Fraction
def an(n):
    a0 = 10
    while n > 0:
        a0 = a0 - 1 / a0
        n-=1
    return a0

if __name__ == '__main__':
    for i in range(100):
        if an(i) <= 0:
            print('{0} = {1}'.format(i,an(i)))
            break
\end{lstlisting}

%問2
\subsection{}
$(x(t),y(t)) = (\cos(3t),\sin(2t))$ , $0 \leq t < 2 \pi$ のグラフをかけ。


\section*{1章から3章のまとめ(作成したプログラムのリスト)}
\begin{tabbing}
1.1 基本数学演算\\
\hspace{5.5mm}\=開始日 2018/09/19 \hspace{2.5mm}\=終了日 2018/09/19\\
1.2 ラベル : 名前に数を割り当てる\\
\>開始日 2018/09/19\>終了日 2018/09/19\\
1.3 ラベル : 名前に数を割り当てる\\
\>開始日 2018/09/19\>終了日 2018/09/19\\
1.3.1 分数を扱う\\
\>開始日 2018/09/19\>終了日 2018/09/19\\
1.3.2 複素数\\
\>開始日 2018/09/19\>終了日 2018/09/19\\
1.4.1 例外と不当入力の処理\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
1.4.2 分数と複素数を入力\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
1.5.1 整数の因数を計算する\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
1.5.2 乗算表を生成する\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
1.5.3 測定単位を変換する\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
1.5.4 2自方程式の解を求める\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
1.6   学んだこと\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
1.7   プログラミングチャレンジ\\
\>開始日 2018/09/26\>終了日 2018/09/26\\
2.1 デカルト座標\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.2 リストやタプル操作\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.3.1 グラフで点を作る\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.3.2 ニューヨーク市の年間平均気温をグラフ化する\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.3.3 ニューヨーク市の月間気温傾向を比較する\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.3.4 グラフのカスタマイズ\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.3.5 プロットの保存\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.4.1 ニュートンの万有引力の法則\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.4.2 投射運動\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.5 学んだこと\\
\>開始日 2018/10/03\>終了日 2018/10/03\\
2.6 プログラミングチャレンジ\\
\>開始日 2018/10/03\>終了日 2018/10/10\\
3.1 平均を求める\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.2 中央値を求める\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.3.1 一番多い要素を見つける\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.3.2 最頻値を探す\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.3.3 度数分布表\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.4.1 数集合の範囲を決める\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.4.2 分散と標準偏差を求める\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.5.1 相関係数を計算する\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.5.2 高校の成績と大学入試の点数\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.6 散布図\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.7.1 テキストファイルからデータを読み込む\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.7.2 CSVファイルからデータを読み込む\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.8 学んだこと\\
\>開始日 2018/10/17\>終了日 2018/10/17\\
3.9 プログラミングチャレンジ\\
\>開始日 2018/10/17\>終了日 2018/10/\\
4.1 式の記号と記号演算を定義する\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.2.1 式の因数分解と展開\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.2.2 プリティプリント\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.2.3 値に代入する\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.2.4 文字列を数式に変換する\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.3.1 2次方程式を解く\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.3.2 1変数を他の変数について解く\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.3.3 連立方程式を解く\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.4.1 ユーザーが入力した式をプロットする\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.4.2 複数の関数をプロットする\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.5 学んだこと\\
\>開始日 2018/11/14\>終了日 2018/11/14\\
4.プログラミングチャレンジ\\
\>開始日 2018/11/14\>終了日 2018/11/21
\end{tabbing}
\end{document}